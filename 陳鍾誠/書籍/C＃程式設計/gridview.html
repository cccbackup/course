<!DOCTYPE html>
  <html>
  <head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.2/katex.min.css">
  <link rel="stylesheet" type="text/css" href="https://ccc-js.github.io/pp6/doc/main.css">
  <!-- 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/atom-one-light.min.css">
  <link rel="stylesheet" type="text/css" href="file:///D:/ccc/js/pp6/doc/main.css"> 
  -->
  </head>
  <body>
  <title></title>
  <header>
    <div style="float:left"><label class="toggle" onclick="toggleSidebar()">≡</label>&nbsp;&nbsp;</div>
    <div style="float:left"><p><a href="../../../陳鍾誠.html" alt="">陳鍾誠</a> / <a href="../../書籍.html" alt="">書籍</a> / <a href="../C＃程式設計.html" alt="">C＃程式設計</a></p>
</div>
  </header>
  <aside>
  <div>
  <h6> <a href="./課程/.html" alt="">課程</a></h6>
<ul>
    <li><a href="./課程/網頁設計.html" alt="">網頁設計</a></li>
    <li><a href="./課程/網站設計.html" alt="">網站設計進階</a></li>
    <li><a href="./課程/計算機結構.html" alt="">計算機結構</a></li>
    <li><a href="./課程/系統程式.html" alt="">系統程式</a></li>
    <li><a href="./課程/人工智慧.html" alt="">人工智慧</a></li>
    <li><a href="./課程/軟體工程.html" alt="">軟體工程</a></li>
</ul>
<h6> <a href="./書籍/.html" alt="">書籍</a></h6>
<ul>
    <li><a href="./書籍/演算法.html" alt="">演算法</a></li>
    <li><a href="./書籍/科學計算.html" alt="">科學計算</a></li>
    <li><a href="./書籍/機率統計.html" alt="">機率統計</a></li>
    <li><a href="./書籍/資料庫.html" alt="">資料庫</a></li>
    <li><a href="./書籍/JavaScript.html" alt="">JavaScript</a></li>
    <li><a href="./書籍/nand2tetris.html" alt="">nand2tetris</a></li>
    <li><a href="./書籍/C語言.html" alt="">C語言</a></li>
    <li><a href="./書籍/Verilog.html" alt="">Verilog</a></li>
    <li><a href="./書籍/圖靈獎.html" alt="">圖靈獎年表</a></li>
</ul>
<h6> <a href="./Home.html" alt="">陳鍾誠</a></h6>
<ul>
    <li><a href="./程式.html" alt="">程式</a></li>
    <li><a href="./作品.html" alt="">作品</a></li>
    <li><a href="./蒐藏.html" alt="">蒐藏</a></li>
</ul>
  </div>
  </aside>
  <article>
  <div class="header">
    
    
    
  </div>
  <h1> C# 視窗程式：DataGridView 與 ListView 元件</h1>

<h2> DataGridView 的使用</h2>

<p>在微軟 .NET 的架構中，DataGridView 是一個強大而複雜的元件，我們欣賞其功能的強大，但也相當畏懼其複雜性，有時我們並不想將這個元件與資料庫綁在一起使用，但是卻不知道應該如何直接在元件中填入表格資料，以下是這個問題的一個簡單解法。</p>

<p>專案下載：<a href="https://dl.dropbox.com/u/101584453/cs/code/MenuGridView.zip">https://dl.dropbox.com/u/101584453/cs/code/MenuGridView.zip</a></p>

<p>設計：當您用 Visual Studio 拉出一個 DataGridView 物件 (假設稱為 dataGridViewMenu) 後，可以點選其屬性中的 Columns 欄位，然後用視覺化的方式加入兩個 Column，並設定好名稱為 name (品名), price (單價)，以下是筆者設定時的畫面。</p>

<p><figure>
  <img src="MenuGridViewColumn.png" alt=""></img>
<figcaption>DataGridView 的設計介面</figcaption></figure>
</p>

<p>授課錄影：C# DataGridView 元件的使用 -- <a href="http://youtu.be/XzsZRqLAi30">http://youtu.be/XzsZRqLAi30</a></p>

<h2> 賣泡沫紅茶的系統 (Point of Sale, POS)</h2>

<p>授課錄影：</p>

<ul>
    <li>C# 製作賣紅茶的 POS 系統 -- <a href="http://youtu.be/XX0wHhvkkiE">http://youtu.be/XX0wHhvkkiE</a></li>
    <li>設計飲料店點菜系統 (1/2: 介面設計) -- <a href="http://youtu.be/4NRzpSNLQ44">http://youtu.be/4NRzpSNLQ44</a></li>
    <li>設計飲料店點菜系統 (2/2: 程式邏輯) -- <a href="http://youtu.be/KO6fENU5Yfo">http://youtu.be/KO6fENU5Yfo</a></li>
</ul>
<p>為了展示如何用 C# 設計一個小型的銷售點系統，我們設計了一個販賣飲料的 POS 軟體，可以讓販售者於電腦上點選飲料與數量，然後系統會自動計算總金額，這個程式可以用 ListView 或 DataGridView 元件進行設計，在上述的專案下載連結中，我們分別設計了這些專案，以下說明是我們使用 DataGridView 的設計方式的結果。</p>

<p>專案下載：</p>

<ul>
    <li>簡易版 -- <a href="https://dl.dropbox.com/u/101584453/cs/code/Menu1.zip">https://dl.dropbox.com/u/101584453/cs/code/Menu1.zip</a> (只有一樣商品：紅茶)</li>
    <li>完整版 -- <a href="https://dl.dropbox.com/u/101584453/cs/code/Menu2.zip">https://dl.dropbox.com/u/101584453/cs/code/Menu2.zip</a> (使用 ListView)</li>
    <li>豪華版 -- <a href="https://dl.dropbox.com/u/101584453/cs/code/POS2012.zip">https://dl.dropbox.com/u/101584453/cs/code/POS2012.zip</a> (2012 年更新版，使用 DataGridView)</li>
</ul>
<p><figure>
  <img src="MenuDesign.png" alt=""></img>
<figcaption>賣泡沫紅茶的系統的畫面設計</figcaption></figure>
</p>

<p>程式碼</p>

<pre class="code"><code class="CS">using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace POS
{
    public partial class FormMenu : Form
    {
        String name; // 品名
        double price; // 單價
        double number; // 數量
        double subTotal; // 小計

        public FormMenu()
        {
            InitializeComponent();

            // 填入銷售項目到菜單中
            DataGridViewRowCollection rows = dataGridViewMenu.Rows;
            rows.Add(new Object[] { "紅茶", 25 }); 
            rows.Add(new Object[] { "綠茶", 25 });
            rows.Add(new Object[] { "奶茶", 30 });
            rows.Add(new Object[] { "珍珠奶茶", 35 });
        }

        private void dataGridViewMenu_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            // 選取某項目，將該項目的品名價格放入待購項目中。
            if (dataGridViewMenu.Rows[e.RowIndex].Cells[0].Value == null)
                return;
            buttonName.Text = dataGridViewMenu.Rows[e.RowIndex].Cells[0].Value.ToString();
            textBoxPrice.Text = dataGridViewMenu.Rows[e.RowIndex].Cells[1].Value.ToString();
        }

        private void buttonAdd_Click(object sender, EventArgs e)
        {
            // 加入紐被按下
            calculateSubTotal(); // 計算小計，並加入到訂單中
            dataGridViewOrder.Rows.Add(new Object[] { name, price, number, subTotal }); 
            calculateTotal(); // 重新計算總價
        }

        private void calculateSubTotal() // 計算小計
        {
            name = buttonName.Text;
            price = double.Parse(textBoxPrice.Text);
            number = (double)numericUpDownNumber.Value;
            subTotal = price * number; // 小計 = 價格 * 數量
            textBoxSubtotal.Text = subTotal.ToString();
        }

        private void calculateTotal() // 計算總價
        {
            double total = 0.0;
            for (int i = 0; i &lt; dataGridViewOrder.Rows.Count; i++)
            {
                DataGridViewRow row = dataGridViewOrder.Rows[i];
                if (row.Cells[0].Value != null)
                    total += (double)row.Cells[3].Value;
            }
            textBoxTotal.Text = total.ToString();
        }

        private void numericUpDownNumber_ValueChanged(object sender, EventArgs e)
        {
            calculateSubTotal(); // 數量修改時，重新計算小計。
        }

        private void buttonTotal_Click(object sender, EventArgs e)
        {
            calculateTotal(); // 按下總價紐時，重新計算總價。
        }
    }
}
</code></pre>

<p>執行結果</p>

<p><figure>
  <img src="MenuRun.png" alt=""></img>
<figcaption>賣泡沫紅茶的系統的執行結果</figcaption></figure>
</p>

<h2> 參考文獻</h2>
<ul>
    <li>Data Binding in .NET / C# Windows Forms -- <a href="http://www.akadia.com/services/dotnet_databinding.html">http://www.akadia.com/services/dotnet_databinding.html</a></li>
    <li>C# DataRow Examples -- <a href="http://dotnetperls.com/datarow">http://dotnetperls.com/datarow</a></li>
    <li>How to bind a DataGridView to a DataSet without a database? -- <a href="http://www.devnewsgroups.net/windowsforms/t57859-how-bind-datagridview-dataset-without-database.aspx">http://www.devnewsgroups.net/windowsforms/t57859-how-bind-datagridview-dataset-without-database.aspx</a></li>
    <li>Data Binding in DataGrid Control - Part 1 -- <a href="http://www.c-sharpcorner.com/UploadFile/mahesh/DataBindingInDataGridMCB112022005002207AM/DataBindingInDataGridMCB1.aspx">http://www.c-sharpcorner.com/UploadFile/mahesh/DataBindingInDataGridMCB112022005002207AM/DataBindingInDataGridMCB1.aspx</a></li>
</ul>
  <div class="reference">
  
  </div>
  </article>
  <footer><p><a href="http://www.nqu.edu.tw/educsie/index.php?act=blog&code=list&ids=4" alt="">陳鍾誠</a> 於 <a href="http://www.nqu.edu.tw/" alt="">金門大學</a> <a href="http://www.nqu.edu.tw/educsie/index.php" alt="">資訊工程系</a> -- 本書衍生自 <a href="https://www.wikipedia.org/" alt="">維基百科</a> ，採用 <a href="https://zh.wikipedia.org/zh-hant/Wikipedia%3ACC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" alt="">CC: BY-SA</a> 授權</p>
</footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.2/katex.min.js"></script>
  <script src="https://ccc-js.github.io/pp6/doc/main.js"></script>
  <!--
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
  <script src="file:///D:/ccc/js/pp6/doc/main.js"></script>
  -->
  </script>
  </body>
  </html>
  