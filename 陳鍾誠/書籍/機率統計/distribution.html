<!DOCTYPE html>
  <html>
  <head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.2/katex.min.css">
  <link rel="stylesheet" type="text/css" href="https://ccc-js.github.io/pp6/doc/main.css">
  <!-- 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/atom-one-light.min.css">
  <link rel="stylesheet" type="text/css" href="file:///D:/ccc/js/pp6/doc/main.css"> 
  -->
  </head>
  <body>
  <title></title>
  <header>
    <div style="float:left"><label class="toggle" onclick="toggleSidebar()">≡</label>&nbsp;&nbsp;</div>
    <div style="float:left"><p><a href="../../../陳鍾誠.html" alt="">陳鍾誠</a> / <a href="../../書籍.html" alt="">書籍</a> / <a href="../機率統計.html" alt="">機率統計</a></p>
</div>
  </header>
  <aside>
  <div>
  <h6> <a href="./陳鍾誠/課程/.html" alt="">課程</a></h6>
<ul>
    <li><a href="./陳鍾誠/課程/網頁設計.html" alt="">網頁設計</a></li>
    <li><a href="./陳鍾誠/課程/網站設計.html" alt="">網站設計進階</a></li>
    <li><a href="./陳鍾誠/課程/計算機結構.html" alt="">計算機結構</a></li>
    <li><a href="./陳鍾誠/課程/系統程式.html" alt="">系統程式</a></li>
    <li><a href="./陳鍾誠/課程/人工智慧.html" alt="">人工智慧</a></li>
    <li><a href="./陳鍾誠/課程/軟體工程.html" alt="">軟體工程</a></li>
</ul>
<h6> <a href="./陳鍾誠/書籍/.html" alt="">書籍</a></h6>
<ul>
    <li><a href="./陳鍾誠/書籍/演算法.html" alt="">演算法</a></li>
    <li><a href="./陳鍾誠/書籍/科學計算.html" alt="">科學計算</a></li>
    <li><a href="./陳鍾誠/書籍/機率統計.html" alt="">機率統計</a></li>
    <li><a href="./陳鍾誠/書籍/資料庫.html" alt="">資料庫</a></li>
    <li><a href="./陳鍾誠/書籍/JavaScript.html" alt="">JavaScript</a></li>
    <li><a href="./陳鍾誠/書籍/nand2tetris.html" alt="">nand2tetris</a></li>
    <li><a href="./陳鍾誠/書籍/C語言.html" alt="">C語言</a></li>
    <li><a href="./陳鍾誠/書籍/Verilog.html" alt="">Verilog</a></li>
    <li><a href="./陳鍾誠/書籍/圖靈獎.html" alt="">圖靈獎年表</a></li>
</ul>
<h6> <a href="./Home.html" alt="">陳鍾誠</a></h6>
<ul>
    <li><a href="./陳鍾誠/程式.html" alt="">程式</a></li>
    <li><a href="./陳鍾誠/作品.html" alt="">作品</a></li>
    <li><a href="./陳鍾誠/蒐藏.html" alt="">蒐藏</a></li>
</ul>
  </div>
  </aside>
  <article>
  <div class="header">
    
    
    
  </div>
  <h1> 機率分布 </h1>

<h2> 簡介</h2>

<p>在程式設計領域，「設計模式」是一些經常被使用到的物件樣式，而在數學領域，也同樣存在著某些「常見模式」，在機率統計領域，這些「常見模式」就是機率分布。</p>

<p>機率分布可以分為「離散型」與「連續型」兩類，離散型的機率分布通常只會有整數型的值，而連續型的機率分布則在整個實數軸上都可能產生樣本。</p>

<h2> 伯努力試驗 (Bernoulli trial) </h2>

<p>所有的離散型機率分布，幾乎都是從「伯努力試驗」這個概念開始的，讓我們先來瞭解一下何謂「伯努力試驗」。</p>

<p>伯努利試驗是一項只有兩種可能結果的隨機試驗，可以用下列機率分布描述：</p>

<p><span class="math inline">P[X=1] = p ; P[X=0] = 1-p</span></p>

<p>換句話說、伯努力試驗是一種 YES or NO (1 or 0) 的試驗。舉例而言，像是「丟銅版、生男生女、一地區某天最高溫是否超過 30 度、擲骰子是否超過 2 點」等等，都可以用伯努力實驗描述。</p>

<p>伯努力試驗的概念很簡單，以下是一些範例：</p>

<p>範例 1 : </p>

<blockquote>
<p> 丟一個公正銅板，用隨機變數 X 將正面映射為 1 ，反面映射為 0，那麼就可以用 P[X=1]=0.5, P[X=0]=0.5 表示這個機率模型。</p>
</blockquote>

<p>在 R 軟體中， Sample 函數可以用來模仿柏努力試驗。</p>

<p>舉例而言，以下是範例一的丟銅板試驗，指令 sample(0:1, 10, replace=T, prob=c(0.5,0.5)) 代表連續進行 10 次柏努力試驗，成功失敗機率各為 0.5。</p>

<pre class="code"><code class="R">&gt; sample(0:1, 10, replace=TRUE, prob=c(0.5,0.5))
 [1] 1 0 1 1 0 1 0 1 0 1
&gt; sample(0:1, 10, replace=T)
 [1] 0 1 1 1 0 0 1 1 1 0
</code></pre>

<p>說明：X(反面)=0, X(正面)=1, 第一個參數 0:1 分別代表 {反面、正面} 的映射結果，而第二個參數代表只投擲一次，第三個參數 replace 代表樣本取後是否放回，這在頭銅板的範例必須用 replace=TRUE, 因為這次投正面之後不代表下次不能再出現正面，而 prob 則是指定的機率分布，如果不指定則代表採用平分的機率分布，以這個例子就是各為 0.5 的方式。</p>

<p>範例 2 : </p>

<blockquote>
<p> 假如用機率描述生男生女這件事， X({生男})=1, X({生女})=0, 且生男生的機率為 0.53, 生女生的機率為 0.47，那麼就可以用 P[X=1]=0.53, P[X=0]=0.47 表示這個機率模型。</p>
</blockquote>

<pre class="code"><code class="R">&gt; sample(0:1, 10, replace=T, prob=c(0.47, 0.53))
 [1] 0 1 1 0 1 1 0 1 1 0
</code></pre>

<h2> 二項分布 (Binomial distribution)</h2>

<p>如果我們進行 n 次的伯努力試驗，每一次的實驗都可以用隨機變數描述， P(ti=1) = p, P(ti=0)=1-p ，而且這些試驗 {t1, t2, ...., tn} 之間是獨立的，那麼我們就可以用二項分布來描述 n 次實驗的可能機率分布。</p>

<p>由於這 n 次實驗相互獨立，假如 (t1 t2 ... tn) 代表這個實驗的一個可能出像，因此 P(t1 t2 .... tn) = P(t1) P(t2) .... P(tn)。</p>

<p>令 X 代表一個可以將 (t1 t2 ... tn) 映射到伯努力試驗成功 (Yes) 次數的函數，那麼、n 次實驗中出現 k 次 1 的機會，可以用以下算式表示。</p>

<p><span class="math inline">P(X=k) =  {n \choose k} p^k (1-p)^{n-k}</span> </p>

<p>舉例而言，投擲公正銅板 5 次，得到 3 次正面的機率為 <span class="math inline">P(X=3) = {5 \choose 3} p^3 (1-p)^{5-3}</span> ，其中 p=0.5。</p>

<p>範例：</p>

<blockquote>
<p> 假如生男生的機率為 0.53, 生女生的機率為 0.47，而且每位母親生男生女的事件之間都是獨立的。</p>
<p> </p>
<p> 某母親 A 想要生 3 個小孩，請問至少有一個男生的機會為多少。</p>
<p> </p>
<p> 用機率描述生男生女這件事， X({生男})=1, X({生女})=0, 那麼可以計算至少生一個男生的機率如下：</p>
<p> </p>
<p> <span class="math inline">P(X>=1) = P(X={2,3}) = \sum_{k \in \{2,3\}} {3 \choose k} p^k (1-p)^{n-k}</span> ，其中 p = 0.53, (1-p) = 0.47。 </p>
</blockquote>

<p>讓我們用 R 軟體計算一下</p>

<pre class="code"><code class="R">&gt; dbinom(1, 3, 0.53)+dbinom(2,3, 0.53)+dbinom(3,3,0.53)
[1] 0.896177
&gt; sum(dbinom(c(1,2,3), 3, 0.53))
[1] 0.896177
&gt; x=c(1,2,3)
&gt; x
[1] 1 2 3
&gt; p=dbinom(x, 3, 0.53)
&gt; p
[1] 0.351231 0.396069 0.148877
&gt; sum(p)
[1] 0.896177
</code></pre>

<h3> 二項分布的圖形</h3>

<pre class="code"><code class="R">&gt; par(mfrow=c(2,2))
&gt; x = 0:5
&gt; b5 = dbinom(x, 5, 0.5)
&gt; plot(x, b5, type="h")
&gt; b3 = dbinom(x, 5, 0.3)
&gt; plot(x, b3, type="h")
&gt; b7 = dbinom(x, 5, 0.7)
&gt; plot(x, b7, type="h")
&gt; b1 = dbinom(x, 5, 0.1)
&gt; plot(x, b1, type="h")
</code></pre>

<p><figure>
  <img src="plotBinom.jpg" alt=""></img>
<figcaption></figcaption></figure>
</p>

<h3> 習題</h3>

<ol>
    <li>請問丟 10 個公平的銅板，有三個正面的機會是多少？</li>
    <li>請問丟 n 個公平的銅板，正面次數 <= k 的機率是多少？</li>
    <li>請問丟 10 個公平的銅板，得到正面次數的期望值為何？</li>
</ol>
<h2> 幾何分布 (Geometric distribution)</h2>

<p>如果我們連續進行一系列的伯努力試驗，直到成功才停止，那麼我們需要進行多少次實驗呢？</p>

<p>關於這種「直到成功才停止」的問題，可以用幾何分布來描述，以下是幾何分布的定義。</p>

<p><span class="math inline">P(X=k) = (1-p)^{k-1} p = q^{k-1} p</span></p>

<p>舉例而言，假如我們連續投擲公正銅版，直到出現正面才停止，那麼我們需要投擲 k 次才會得到第一個正面的機率，就會是 <span class="math inline">(1-p)^{k-1} p</span> ，其中的 p=0.5。</p>

<p>範例：</p>

<blockquote>
<p> 假如生男生的機率為 0.53, 生女生的機率為 0.47，而且每位母親生男生女的事件之間都是獨立的。</p>
<p> </p>
<p> 某位母親決定要一直生小孩，直到有一個女孩為止，請問她在生小孩個數不大於三個就能完成任務的機率為多少？</p>
<p> </p>
<p> 用機率描述生男生女這件事， X({生女})=1, X({生男})=0, 那麼就可以累加下列算式以計算結果。</p>
<p> </p>
<p> <span class="math inline">\sum_{k=1}^{3} P(X=k) = \sum_{k=1}^{3} (1-p)^{k-1} p = \sum_{k=1}^{3} (1-0.47)^{k-1} 0.47</span> </p>
</blockquote>

<p>讓我們用 R 軟體計算一下，必須注意的是，R 軟體中的幾何分布 dgeom 的定義為 <span class="math inline">p(x) = p (1-p)^x</span> ，也就是用失敗次數當 x，因此其公式與上面的有所不同，必須修改如下：(其中的 x 代表失敗次數)。</p>

<p><span class="math inline">P(X=x) = (1-p)^{x} p = q^{x} p</span></p>

<pre class="code"><code class="R">&gt; dgeom(0, 0.47) # 0 次失敗，第 1 次就成功。
[1] 0.47
&gt; dgeom(1, 0.47) # 1 次失敗，第 2 次才成功。
[1] 0.2491
&gt; sum(dgeom(c(0,1,2), 0.47)) # 失敗 &lt;= 2 次，生小孩不大於 3 個就成功了。
[1] 0.851123
</code></pre>

<h3> 習題</h3>

<ol>
    <li>請問丟公平的銅板時，得到第 1 次正面時投擲次數 k 的機率分布為何？該分布的期望值為何？</li>
    <li>請問丟公正的骰子時，得到第 1 次 6 點時投擲次數 k 的機率分布為何？該分布的期望值為何？</li>
</ol>
<h2> 負二項分布</h2>

<p>如果我們對「幾何分布」進行擴充，改成「持續進行試驗直到取得 r 次成功為止」，那麼其機率分布又該如何描述呢？</p>

<p>這樣的機率分布就稱為負二項分布，其公式如下：</p>

<p><span class="math inline">P(X=k) = {k-1 \choose r-1} (1-p)^{k-r} p^r</span></p>

<p>舉例而言，假如我們連續投擲公正銅版，直到出現三次正面才停止，那麼我們需要投擲 k 次才會得到第一個正面的機率，就會是 <span class="math inline">{k-1 \choose r-1} (1-p)^{k-r} p^r</span>，其中的 p=0.5。</p>

<p>讓我們用 R 軟體計算一下，必須注意的是，R 軟體中的負二項分布 dbinom 的定義為 <span class="math inline">\Gamma(x+n)/(\Gamma(n) x!) p^n (1-p)^x</span> ，也就是用 n=r, x=k-r-1 的代換方式。</p>

<p>其中的 x 同樣代表失敗次數，而 n 代表成功次數，Γ(n) 代表排列數，所以 Γ(x+n)/(Γ(n) x!) 其實也就是 (x+n-1)!/((n-1)! x!) ，也就是 <span class="math inline">{x+n-1 \choose x}</span> 的意思。</p>

<p>R 的操作範例</p>

<pre class="code"><code class="R">&gt; dnbinom(0, 3, 0.5) # 失敗 0 次，連續成功 3 次。
[1] 0.125
&gt; dnbinom(1, 3, 0.5) # 失敗 1 次，成功 3 次，第 4 次才達到 3 次成功。
[1] 0.1875
&gt; dnbinom(0:10, 3, 0.5) # 失敗 10 次以下，成功 3 次，第 13 次前就成功 3 次。
 [1] 0.125000000 0.187500000 0.187500000 0.156250000 0.117187500 0.082031250
 [7] 0.054687500 0.035156250 0.021972656 0.013427734 0.008056641
&gt; n=3
&gt; x=1 
&gt; p=0.5
&gt; gamma(x+n)/(gamma(n)*prod(1:x)) * p^n * (1-p)^x
[1] 0.1875
&gt; choose(x+n, n) * p^n * (1-p)^x
[1] 0.25
&gt; choose(x+n-1, x) * p^n * (1-p)^x
[1] 0.1875
</code></pre>

<p>範例：</p>

<blockquote>
<p> 假如生男生的機率為 0.53, 生女生的機率為 0.47，而且每位母親生男生女的事件之間都是獨立的。</p>
<p> </p>
<p> 某位母親決定要一直生小孩，直到有三個女孩為止，請問她在生小孩個數不大於 5 個就能完成任務的機率為多少？</p>
<p> </p>
<p> 用機率描述生男生女這件事， X({生女})=1, X({生男})=0, 那麼就可以累加下列算式以計算結果。</p>
<p> </p>
<p> <span class="math inline">\sum_{k=1}^{5} P(X=k) = \sum_{k=1}^{5} {k-1 \choose r-1} (1-p)^{k-r} p^r</span> , 其中 p=0.47, r=3。</p>
</blockquote>

<p>但是由於 R 是用失敗次數，所以必須改成：</p>

<blockquote>
<p> <span class="math inline">\sum_{k=1}^{5} P(X=k) = \sum_{x=0}^{2} {x+n-1 \choose x-1} (1-p)^x p^n</span> , 其中 p=0.47, n=3。</p>
</blockquote>

<p>於是操作如下：</p>

<pre class="code"><code class="R">&gt; dnbinom(0, 3, 0.47)
[1] 0.103823
&gt; dnbinom(1, 3, 0.47)
[1] 0.1650786
&gt; dnbinom(2, 3, 0.47)
[1] 0.1749833
&gt; dnbinom(c(0,1,2), 3, 0.47)
[1] 0.1038230 0.1650786
[3] 0.1749833
&gt; sum(dnbinom(c(0,1,2), 3, 0.47))
[1] 0.4438849
&gt;
</code></pre>

<h3> 負二項分布的圖形</h3>

<pre class="code"><code class="R">&gt; par(mfrow=c(2,2))
&gt; nb5 = dnbinom(x, 5, 0.5)
&gt; plot(nb5, type="h")
&gt; nb7 = dnbinom(x, 5, 0.7)
&gt; plot(nb7, type="h")
&gt; nb2 = dnbinom(x, 5, 0.2)
&gt; plot(nb2, type="h")
&gt; nb9 = dnbinom(x, 5, 0.9)
&gt; plot(nb9, type="h")
</code></pre>

<p><figure>
  <img src="plotNbinom.jpg" alt=""></img>
<figcaption></figcaption></figure>
</p>

<h2> 布瓦松分布 (Poisson distribution)</h2>

<p>在離散機率分布當中，布瓦松分布算是相當特別的一個，因為「布瓦松分布」是描述「連續區域內出現幾個樣本」的分布。舉例而言，像是舀一瓢水會撈到的草履蟲數量，或者抽一滴血會抽到的白血球數量等等。</p>

<p>布瓦松分布的公式如下所示，其中的 <span class="math inline">\lambda</span> 代表每單位區域內會出現的樣本平均數。</p>

<p><span class="math inline">P(X=k) = \lambda^k e^{-\lambda}/k!</span></p>
<p></p>

<p>要瞭解布瓦松分布，得從二項分布的極限開始想起，以下是三種不同 <span class="math inline">\lambda</span> 參數的布瓦松分布圖：</p>

<p><figure>
  <img src="PoissonCurve.jpg" alt=""></img>
<figcaption>圖、布瓦松分布&lt;BR/&gt;來源：&lt;http://en.wikipedia.org/wiki/Poisson_distribution&gt;</figcaption></figure>
</p>

<p>事實上、布瓦松分布是二項分布在 n 趨近無限大的極限情況。</p>

<p><figure>
  <img src="PoissonVsBinomial.jpg" alt=""></img>
<figcaption>圖、布瓦松分布是二項分布 n 趨近無限大的極限情況&lt;BR/&gt;來源：&lt;http://en.wikipedia.org/wiki/File:Binomial_versus_poisson.svg&gt;</figcaption></figure>
</p>

<p>為了說明布瓦松分布與二項分布之間的關係，讓我們用以下的白血球範例來看看隱藏在這兩個分布背後的關係：</p>

<p>範例：抽血時白血球數量的問題</p>

<blockquote>
<p> 問題： 假如現在從你身上抽一滴血，請回答下列兩個問題。</p>
<p> </p>
<p> 1 - 請定義一個隨機變數 X 代表那滴血中的白血球數量。</p>
<p> </p>
<p> 提示： 樣本空間 S = 此時此刻你身上的所有白血球 = {w1,w2,......,wn}</p>
<p> </p>
<p> 2 - 請算出一滴血液中有三顆白血球的機率，假設該滴血液占你總血量的 1/1000。</p>
</blockquote>

<p>解答 1：</p>

<blockquote>
<p>  X(A) = |A|</p>
<p> </p>
<p> 說明： </p>
<p> </p>
<p> A 是一個事件，也就是白血球的樣本空間 S 的子集合，例如： A = {w1, w5, w9}</p>
<p> </p>
<p> |A| 代表 A 集合的大小，也就是元素個數，舉例而言：</p>
<p> </p>
<p>   如果 A = {w1, w5, w9} ，那麼 |A| = 3</p>
<p> </p>
<p>   如果 B = {w2, w8}，那麼 |B| = 2</p>
<p> </p>
<p>   如果 C = {}，那麼 |C| = 0</p>
<p> </p>
<p>   如果 D = S，那麼 |D| = n</p>
</blockquote>

<p>解答 2：</p>

<blockquote>
<p> P(X=3) = P({A | X(A) = 3}) = P({{w1, w2, w3}) + P({w1, w2, w4}) + ......</p>
<p> </p>
<p> 假如任一顆白血球被抽到的機率等於該滴血液佔全身血液的比率，由於該滴血液佔總血量的 1/1000，所以給顆白血球被抽到的機率為 1/1000。</p>
<p> </p>
<p> 而且假設這些白血球沒有智慧，也不會聚合在一起，因此相互之間獨立，那麼由於每顆白血球被抽到的機率為 1/1000，因此 P(w1) = P(w2) = .... P(wn) = 1/1000。</p>
<p> </p>
<p> 那麼初步想法是 P(w1w3) = P(w1) <strong> P(w3) = 1/1000 </strong> 1/1000 。</p>
<p> </p>
<p> 但是上述的想法有個小問題，那就是該情況代表其它白血球都沒被抽到，因此所謂的 P(w1w3) 真正的意思應該是</p>
<p> </p>
<p> <span class="math inline">P(w_1 \bar{w_2} w_3 \bar{w_4} .... \bar{w_n}) = (\frac{1}{1000})^2  (\frac{999}{1000})^{n-2}</span></p>
<p> </p>
<p> 所以 P(X=3) 應該算法如下：</p>
<p> </p>
<p> <span class="math inline">P(X=3) = P(\{A| X(A) = 3\}) = (\frac{1}{1000})^3  (\frac{999}{1000})^{n-3}  {n \choose 3}</span></p>
<p> </p>
<p> 推而廣之，P(X=k) 的機率之算法如下：</p>
<p> </p>
<p> <span class="math inline">P(X=k) = P(\{A| X(A) = k\}) = (\frac{1}{1000})^k  (\frac{999}{1000})^{n-k}  {n \choose k}</span></p>
<p> </p>
<p> 事實上，這個題目的機率分布就是下一章的二項分布，如下所示：</p>
<p></p>
<p> <span class="math inline">P(X=k) = {n \choose k} p^k (1-p)^{n-k}</span></p>
<p> </p>
<p> 而且、當 n 趨近於無限大時，這個分布將會趨近於布瓦松分布，如下所示：</p>
<p> </p>
<p> <span class="math inline">P(X=k) = \lambda^k e^{-\lambda}/k!</span></p>
<p> </p>
<p> 其中的 λ 之意義為，在單位時間 (或單位面積、體積) 內，事件的出現次數平均為 λ 次。</p>
</blockquote>

<h3> 習題</h3>

<p>習題：假設每 1CC 的血所含的白血球平均為 10 顆，那麼請問你抽 1CC 的血時，抽到 8 顆白血球的機率是多少。</p>

<p>解答：</p>

<blockquote>
<p> λ = 10，因此布瓦松分布為 <span class="math inline">p(x) = 10^x e^{-10}/x!</span> ，將 x=8 代入，得到 <span class="math inline">p(8) = 10^8 e^{-10}/8!</span> </p>
</blockquote>

<p>其數值可以用 R 軟體計算，如下所示：</p>

<pre class="code"><code class="R">&gt; ?dpois
&gt; dpois(8, 10)
[1] 0.112599
&gt; 10^8*e^(-10)/factorial(8)
[1] 0.01125998
&gt;
</code></pre>

<p>抽到 12 個白血球的機率 (λ = 10)</p>

<pre class="code"><code class="R">&gt; dpois(12, 10)
[1] 0.09478033
</code></pre>

<p>假如平均抽一滴血液的白血球數量為 5.5 個，請問抽一滴血得到 3 個白血球的機率。</p>

<pre class="code"><code class="R">&gt; dpois(3, 5.5)
[1] 0.1133228
&gt; 5.5^3*e^(-5.5)/factorial(3)
[1] 0.1133232
</code></pre>

<h3> 布瓦松分布的圖形</h3>

<pre class="code"><code class="R">&gt; par(mfrow=c(2,2))
&gt; x = 0:10
&gt; p3 = dpois(x, lambda=3)
&gt; plot(p3, type="h")
&gt; p7 = dpois(x, lambda=7)
&gt; plot(p7, type="h")
&gt; p1 = dpois(x, lambda=1)
&gt; plot(p1, type="h")
&gt; p5 = dpois(x, lambda=5)
&gt; plot(p5, type="h")
</code></pre>

<p><figure>
  <img src="plotPoisson.jpg" alt=""></img>
<figcaption></figcaption></figure>
</p>
<p></p>

<h3> 為何二項分布在 n 很大時會趨近布瓦松分布呢？</h3>

<blockquote>
<p> 根據二項分布的公式</p>
<p> </p>
<p> <span class="math inline">P(X=k) = {n \choose k} p^k (1-p)^{n-k}</span></p>
<p> </p>
<p> 假如 n 很大，且抽取 1 單位體積內的平均個數為 λ，總體積為 M，則總共的個數 n = M λ，且每個樣本被抽到的機會為 1/M。</p>
<p> </p>
<p> 而且、當 n 趨近於無限大，也就是 M 趨近無限大時，上述分布可以改寫如下。</p>
<p> </p>
<p> <span class="math inline">\lim_{n\to\infty} P(X=k) = {n \choose k} p^k (1-p)^{n-k} = {M \lambda \choose k} (1/M)^k (1-(1/M))^{M \lambda-k}</span></p>
<p> </p>
<p> 當 k 很小時， <span class="math inline">(1-(1/M))^{M \lambda-k} \sim (1-(1/M))^{M \lambda} = e^{-\lambda}</span> 且 <span class="math inline">{M \lambda \choose k} = (M \lambda)*(M \lambda-1)...(M \lambda-k)/k! \sim (M \lambda)^k/k! </span></p>
<p> </p>
<p> 所以可得 <span class="math inline"> {M \lambda \choose k} (1/M)^k (1-(1/M))^{M \lambda-k} \sim (M \lambda)^k/(M^k k!) e^{-\lambda} = \lambda^k e^{-\lambda}/k!</span></p>
<p> </p>
<p> 所以可得 <span class="math inline">P(X=k) = \lambda^k e^{-\lambda}/k!</span> </p>
</blockquote>
<p></p>

<h2> 均勻分布 (Uniform distribution)</h2>

<h3> 均勻分布的圖形</h3>

<pre class="code"><code class="R">&gt; dunif(0.5)
[1] 1
&gt; dunif(0.9)
[1] 1
&gt; dunif(2)
[1] 0
&gt; dunif(-1)
[1] 0
&gt; par(mfrow=c(2,2))
&gt; x=0:10
&gt; curve(dunif(x, min=0, max=1), from=-1, to=11)
&gt; curve(dunif(x, min=0, max=10), from=-1, to=11)
&gt; curve(dunif(x, min=3, max=6), from=-1, to=11)
&gt; curve(dunif(x, min=2, max=9), from=-1, to=11)
</code></pre>

<p><figure>
  <img src="curveUnif22.jpg" alt=""></img>
<figcaption></figcaption></figure>
</p>

<h2> 常態分布 (Normal Distribution)</h2>

<h3> 常態分布的圖形</h3>

<pre class="code"><code class="R">&gt; dnorm(0)
[1] 0.3989423
&gt; dnorm(0.5)
[1] 0.3520653
&gt; dnorm(2.5)
[1] 0.0175283
&gt; par(mfrow=c(2,2))
&gt; curve(dnorm(x, mean=0, sd=1), from=-10, to=10)
&gt; curve(dnorm(x, mean=0, sd=5), from=-10, to=10)
&gt; curve(dnorm(x, mean=5, sd=1), from=-10, to=10)
&gt; curve(dnorm(x, mean=-3, sd=3), from=-10, to=10)
</code></pre>

<p><figure>
  <img src="curveNorm22.jpg" alt=""></img>
<figcaption></figcaption></figure>
</p>

<h2> 附件：離散型機率分布表格整理</h2>

<p>以下是離散型機率分布的匯總表格，讀者現在還看不懂的話沒有關係，我們在後文中會解說其中較重要的幾個分布。</p>

<table>
<tr><th> 離散機率模型 </th><th> 密度函數 </th><th> R 函數名稱 </th><th> 說明 </th></tr>

<tr><td> 二項分布 </td><td> <span class="math inline">{n \choose x} p^x (1-p)^{n-x}</span> </td><td> binom(n:size, p:prob) </td><td> n:樣本數, p:正面機率, <a href="br/">br/</a> n 次試驗中有 x 個成功的機率 </td></tr>
<tr><td> 多項分布    </td><td> <span class="math inline">\frac{n!}{x_1!...x_k!}  p_1^{x_1}...p_k^{x_k}</span> </td><td> multinom(n:size, p(1..k):prob) </td><td> n:樣本數, p[1..n]:各項的機率  </td></tr>
<tr><td> 負二項分布 </td><td> <span class="math inline">{x-1 \choose r-1} (1-p)^{x-r} p^r</span> </td><td> nbinom(size, prob) </td><td> x:樣本數, , p:正面機率, <a href="br/">br/</a> 要得到第 r 次成功所需要的試驗次數 </td></tr>
<tr><td> 幾何分布    </td><td> <span class="math inline">(1-p)^{x-1} p</span> </td><td> geom(p:prob) </td><td> p: 成功機率, 第一次成功所需要的試驗次數 </td></tr>
<tr><td> 超幾何分布    </td><td> <span class="math inline">\frac{{ r \choose x} {N-r \choose n-x}}{N \choose n}</span> </td><td> hyper(N:m,n:n,r:k) </td><td> m:白球數量, n:黑球數量, k:抽出球數, <a href="br/">br/</a> 同二項分布，但取樣後不放回 </td></tr>
<tr><td> 布瓦松分布    </td><td> <span class="math inline">\frac{e^{-\lambda s} {\lambda s}^x}{x!}</span> </td><td> pois(lambda) </td><td> k:期望值, <span class="math inline">\lambda = \frac{k}{s}</span>, <a href="br/">br/</a> 在 s 時間內，事件出現平均 k 次 </td></tr>
</table>

<h2> 附件：連續型機率分布表格整理</h2>

<p>以下是連續型機率分布的匯總表格，讀者現在還看不懂的話沒有關係，我們在後文中會解說其中較重要的幾個分布。</p>

<table>
<tr><th> 連續機率模型 </th><th> 密度函數 </th><th> R 函數 </th><th> 說明 </th></tr>

<tr><td> 均勻分布 (Uniform) </td><td> <span class="math inline">\frac{1}{b-a}</span> </td><td> unif(a:min, b:max) </td><td> a:範圍下限, b: 上限 <a href="br/">br/</a> 出現機會均等 </td></tr>
<tr><td> 常態分布(Normal) </td><td> <span class="math inline">\frac{1}{\sqrt{2\pi} \sigma} e^{- \frac{1}{2} [(x-\mu)/\sigma]^2}</span> </td><td> norm(mean, sd) </td><td> 中央極限定理：x1+x2+...+xk; 當 k 越大就越接近常態分布 </td><td> </td></tr>
<tr><td> 伽瑪分布 (Gamma) </td><td> <span class="math inline">\frac{1}{\Gamma(a) b^{a}} x^{a-1} e^{-x/b}</span> </td><td> gamma(shape, rate = 1, scale = 1/rate) </td><td>  <span class="math inline">\Gamma(k) = \int_{0}^{\infty} z^{k-1} e^{-z} dz</span> <a href="br/">br/</a>  指數分布與卡方分布都是 Gamma 分布的特例 </td></tr>
<tr><td> 指數分布    (Exponential)</td><td> <span class="math inline">\frac{1}{b} e^{-x/b}</span> </td><td> exp(rate) </td><td> 伽瑪分布(<span class="math inline">a=1, b=\frac{1}{\lambda}</span>) <a href="br/">br/</a> 布瓦松過程中，第一次事件出現的時間 W </td></tr>
<tr><td> 卡方分布 (Chi-Square) </td><td>  <span class="math inline">\frac{1}{2^{\gamma/2}\Gamma(\gamma/2)}\,x^{\gamma/2 - 1} e^{-x/2}</span> </td><td> chisq(df, ncp) </td><td> 伽瑪分布( <span class="math inline">b=2, a=\gamma/2</span> ) <a href="br/">br/</a> 利用樣本推斷母體變異數 </td><td> </td></tr>
<tr><td> 柯西分布 (Cauchy) </td><td> <span class="math inline">\frac{1}{\pi} \frac{a}{a^2 + (x-b)^2}</span> </td><td> cauchy(b:location, a:scale)  </td><td> </td></tr>
<tr><td> 威布爾分布 (Weibull)</td><td> <span class="math inline">a b x^{b-1} e^{-a x^{b}}</span> </td><td> weibull(a:shape, b:scale) </td><td> <span class="math inline">\rho(t)=\frac{f(t)}{R(t)}</span> <a href="br/">br/</a> 可靠度工程：f(x) 失敗時間, R(t) 可靠度,<span class="math inline">\rho(t)</span> 失敗率 </td></tr>
<tr><td> T 分布 (T)    </td><td> <span class="math inline">\frac{Z}{\sqrt{X_{\gamma}^2/\gamma}}</span> </td><td> t(df, ncp) </td><td> 估計變異數時使用的分布 </td><td> </td></tr>
<tr><td> F 分布 (F)    </td><td>  <span class="math inline">\frac{ X_{ \gamma_1 }^2 / \gamma_1 }{ X_{ \gamma_2 }^2/ \gamma_2 }</span> </td><td>  f(df1, df2, ncp) </td><td> 等變異數 F 檢定時使用 </td><td> </td></tr>
<tr><td> 貝塔分布 (Beta) </td><td>   </td><td> beta(a:shape1, b:shape2, ncp) </td><td>  </td><td> </td></tr>
<tr><td> 對數常態分布     (Log Normal) </td><td> </td><td>  lnorm(meanlog, sdlog) </td><td> </td><td> </td></tr>
<tr><td> 邏輯分布    </td><td> </td><td> logis(location, scale)    </td><td> </td></tr>
<tr><td> Signrank    </td><td> </td><td> signrank(n)    </td><td> </td></tr>
<tr><td> 威爾斯    </td><td> </td><td> wilcox(m, n) </td><td> a,b 為兩組樣本 </td></tr>
</table>

  <div class="reference">
  
  </div>
  </article>
  <footer><p><a href="http://www.nqu.edu.tw/educsie/index.php?act=blog&code=list&ids=4" alt="">陳鍾誠</a> 於 <a href="http://www.nqu.edu.tw/" alt="">金門大學</a> <a href="http://www.nqu.edu.tw/educsie/index.php" alt="">資訊工程系</a> -- 本書衍生自 <a href="https://www.wikipedia.org/" alt="">維基百科</a> ，採用 <a href="https://zh.wikipedia.org/zh-hant/Wikipedia%3ACC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" alt="">CC: BY-SA</a> 授權</p>
</footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.2/katex.min.js"></script>
  <script src="https://ccc-js.github.io/pp6/doc/main.js"></script>
  <!--
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
  <script src="file:///D:/ccc/js/pp6/doc/main.js"></script>
  -->
  </script>
  </body>
  </html>
  